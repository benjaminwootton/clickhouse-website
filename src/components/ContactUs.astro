---
// Components
import Button from "components/Button.astro";

const { image, imageAlt } = Astro.props;

interface Props {
    image?: ImageMetadata,
    imageAlt?: string,
}

const inputStyle = `block rounded-xl p-4 text-base mt-2 w-full`
---

<section class="wrapper">
    <div class="text-center mx-auto max-w-[65rem]">
        <slot />
    </div>

    <form 
        class="
            mx-auto max-w-[50rem] [&_label]:py-3 [&_label]:block
            bg-yellow rounded-2xl py-6 px-4 md:py-10 md:px-12 mt-10
        "
        action="https://api.web3forms.com/submit"
        method="POST"
        id="contact-form"
    >

        <input type="hidden" name="access_key" value="494835c2-57fc-40d2-8599-e3a509841384">

        <div class="md:flex md:gap-6">
            <label class="flex-[1]">
                First Name
                <input class={inputStyle} placeholder="First Name" type="text" name="First Name" required>
            </label>

            <label class="flex-[1]">
                Last Name
                <input class={inputStyle} placeholder="Last Name" type="text" name="Last Name" required>
            </label>
        </div>

        <label>
            Email
            <input class={inputStyle} placeholder="Email" type="email" name="Email" required>
        </label>

        <label>
            Subject
            <input class={inputStyle} placeholder="Subject" type="text" name="Subject">
        </label>

        <label>
            Message
            <textarea class={inputStyle} placeholder="Type your message..." name="Message" required rows={5} />
        </label>

        <input type="checkbox" name="botcheck" class="hidden" style="display: none;">

        <!-- <input type="hidden" name="redirect" value="https://mywebsite.com/thanks.html"> -->

        <Button 
            text="Submit"
            button
            insertClass="min-w-[16rem] !block mx-auto !mt-6 !mb-4 hover:!bg-[#ea864b]"
        />
    </form>

    <script is:inline>
        document.getElementById('contact-form').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            
            fetch(form.action, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Create thank you message element
                    const thankYouMessage = document.createElement('div');
                    thankYouMessage.innerHTML = `
                        <div class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
                            <div class="bg-white p-8 rounded-lg text-center max-w-md shadow-xl">
                                <h2 class="text-2xl font-bold mb-4 text-orange">Thank You!</h2>
                                <p class="mb-6">Your message has been successfully submitted. We'll get back to you soon.</p>
                                <button id="close-thank-you" class="bg-orange text-white px-6 py-2 rounded hover:bg-[#ea864b] transition">Close</button>
                            </div>
                        </div>
                    `;
                    
                    // Add to body
                    document.body.appendChild(thankYouMessage);
                    
                    // Clear form
                    form.reset();
                    
                    // Close button functionality
                    document.getElementById('close-thank-you').addEventListener('click', () => {
                        document.body.removeChild(thankYouMessage);
                    });
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('There was an error submitting your form. Please try again.');
            });
        });
    </script>
</section>
